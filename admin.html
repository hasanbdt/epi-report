<!-- ‚úÖ Filter + Final Report Enabled Version -->
<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</title>
  <style>
    body {
      font-family: "Siyam Rupali", sans-serif;
      background: #fffdee;
      padding: 20px;
      max-width: 98%;
      margin: auto;
    }
    h2, h3 {
      text-align: center;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 6px;
      text-align: center;
      font-size: 14px;
    }
    th {
      background-color: #007f5f;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #f7f7f7;
    }
    button {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    .edit-btn { background-color: #f0ad4e; color: white; }
    .delete-btn { background-color: #d9534f; color: white; }
    .filter-area {
      margin: 20px 0;
      text-align: center;
    }
    .filter-area input, .filter-area select {
      padding: 5px 10px;
      margin: 0 5px;
      font-size: 14px;
    }
	
	@media print {
      #finalActions, button {
        display: none !important;
      }
      th {
        background-color: #007f5f !important;
        color: white !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
	
	.institute-header {
	  text-align: center;
	  margin-bottom: 10px;
	  margin-top: 10px;
	  font-family: 'Siyam Rupali', sans-serif;
	}

	.institute-header .logo {
	  width: 100px;
	  height: auto;
	  vertical-align: middle;
	  margin-bottom: 0px;
	}

	.institute-header h1 {
	  color: #007f5f;
	  margin: 5px 0 2px 0; /* ‡¶â‡¶™‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßá ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ ‡¶ï‡¶Æ */
	  font-size: 24px;
	}

	.institute-header h3 {
	  color: #555;
	  margin: 2px 0 10px 0;
	  font-size: 16px;
	  font-weight: normal;
	}
</style>
</head>
<body> 

<!-- ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ -->
<div id="passwordPrompt" style="text-align:center; margin-top:100px;">
  <h2>üîê ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®:</h2>
  <input type="password" id="pagePassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®" style="padding:10px; font-size:16px;"/>
  <br><br>
  <button onclick="verifyPassword()" style="padding:8px 20px; font-size:16px;">‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü</button>
  <p id="errorText" style="color:red; margin-top:10px;"></p>
</div>

<div id="mainContent" style="display:none;">
  <!-- ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∂‡ßá‡¶∑ -->

<!-- Base URL for relative links -->
<base href="https://hasanbdt.github.io/epi-report/">

<!-- ‚úÖ Navigation Menu Start -->
<style>
  .nav-links {
    background-color: #007f5f;
    padding: 10px 0;
    text-align: center;
    border-radius: 10px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .nav-links a {
    color: white;
    text-decoration: none;
    margin: 0 15px;
    font-size: 16px;
    font-weight: bold;
    padding: 8px 12px;
    border-radius: 6px;
    transition: background-color 0.3s ease;
  }

  .nav-links a:hover {
    background-color: #34a0a4;
  }
</style>

<div class="nav-links">
  <a href="https://hasanbdt.github.io/epi-report/index.html">üì• ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ</a>
  <a href="https://hasanbdt.github.io/epi-report/list.html">üìã ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶∏‡¶Æ‡ßç‡¶Æ‡¶ø‡¶≤‡¶ø‡¶§</a>
  <a href="https://hasanbdt.github.io/epi-report/list-final.html">‚≠ê ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ö‡ßÇ‡ßú‡¶æ‡¶®‡ßç‡¶§</a>
  <a href="https://hasanbdt.github.io/epi-report/edit.html">‚≠ê ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ</a>
  <a href="https://hasanbdt.github.io/epi-report/admin.html">‚≠ê ‡¶è‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</a>
</div> 
<!-- ‚úÖ Navigation Menu End -->

<div class="institute-header">
  <img src="epi.png" alt="Logo" class="logo" />
  <h1>‡¶á‡¶™‡¶ø‡¶Ü‡¶á ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡¶ø, ‡¶¢‡¶æ‡¶ï‡¶æ</h1>
  <h3>‡¶∏‡ßç‡¶¨‡¶™‡ßç‡¶® ‡¶™‡ßÇ‡¶∞‡¶£‡ßá ‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ‡¶∞ ‡¶™‡¶•‡ßá...</h3>
</div>

  <h2>üìã ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h2>
  
  <div class="filter-area">
    <input type="date" id="dateFilter">
    <input type="text" id="nameFilter" placeholder="‡¶®‡¶æ‡¶Æ">
    <select id="classFilter">
      <option value="">‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
      <option value="One">One</option>
      <option value="Two">Two</option>
	  <option value="Three">Three</option>
	  <option value="Four">Four</option>
	  <option value="Five">Five</option>
	  <option value="Six">Six</option>
	  <option value="Seven">Seven</option>
	  <option value="Eight">Eight</option>
	  <option value="Nine">Nine</option>
	  <option value="Ten">Ten</option>
    </select>
    <button onclick="refreshList()">üîç ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <button onclick="clearFilters()">üîÑ ‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®</button>
    <button onclick="generateFinalReport()">üìä ‡¶ö‡ßÇ‡ßú‡¶æ‡¶®‡ßç‡¶§ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤</button>
  </div>

  <table id="reportTable">
    <thead>
      <tr>
        <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
        <th>‡¶®‡¶æ‡¶Æ</th>
        <th>‡¶ï‡ßç‡¶≤‡¶æ‡¶∏</th>
        <th>‡¶∞‡ßã‡¶≤</th>
        <th>‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ üåü</th>
        <th>‡¶¶‡¶ø‡¶®</th>
        <th>‡¶∂‡ßá‡¶ñ‡¶æ</th>
        <th>‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú</th>
        <th>‡¶≠‡ßÅ‡¶≤</th>
        <th>‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶æ</th>
        <th>‡¶≠‡¶æ‡¶¨‡¶®‡¶æ</th>
        <th>‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú</th>
        <th>P H M</th>
        <th>‚úèÔ∏è</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div id="finalReport" style="margin-top:30px; display:none;"> 

	<style>
	.institute-header {
	  text-align: center;
	  margin-bottom: 10px;
	  margin-top: 10px;
	  font-family: 'Siyam Rupali', sans-serif;
	}

	.institute-header .logo {
	  width: 100px;
	  height: auto;
	  vertical-align: middle;
	  margin-bottom: 0px;
	}

	.institute-header h1 {
	  color: #007f5f;
	  margin: 5px 0 2px 0; /* ‡¶â‡¶™‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßá ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ ‡¶ï‡¶Æ */
	  font-size: 24px;
	}

	.institute-header h3 {
	  color: #555;
	  margin: 2px 0 10px 0;
	  font-size: 16px;
	  font-weight: normal;
	}
	</style> 
  
	<div class="institute-header">
	  <img src="epi.png" alt="Logo" class="logo" />
	  <h1>‡¶á‡¶™‡¶ø‡¶Ü‡¶á ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡¶ø, ‡¶¢‡¶æ‡¶ï‡¶æ</h1>
	  <h3>‡¶∏‡ßç‡¶¨‡¶™‡ßç‡¶® ‡¶™‡ßÇ‡¶∞‡¶£‡ßá ‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ‡¶∞ ‡¶™‡¶•‡ßá...</h3>
    </div>
	<h3 style="text-align:center; color:#007f5f; font-size: 30px; margin-bottom: 10px;">üìã ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶ö‡ßÇ‡ßú‡¶æ‡¶®‡ßç‡¶§ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ </h3>

    <table id="finalTable">
      <thead>
        <tr>
          <th>‡¶®‡¶æ‡¶Æ</th>
          <th>‡¶ï‡ßç‡¶≤‡¶æ‡¶∏</th>
          <th>‡¶∞‡ßã‡¶≤</th>
          <th>‡¶Æ‡ßã‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞</th>
          <th>‡¶∏‡ßç‡¶ü‡¶æ‡¶∞</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
	
	<p style= "font-size:15px; color: red; text-align: center;"> ‡¶∏‡ßå‡¶≠‡¶æ‡¶ó‡ßç‡¶Ø ‡¶§‡¶æ‡¶∞; ‡¶Ø‡¶æ‡¶∞ ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¶‡¶ø‡¶®‡¶ü‡¶ø ‡¶ó‡¶§‡¶ï‡¶æ‡¶≤‡ßá‡¶∞ ‡¶ö‡ßá‡ßü‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶Æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§</p>
	
     <div id="finalActions" style="text-align:center; margin-top:20px">
     <button onclick="printFinalReport()">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü PDF</button>
     <button onclick="exportToExcel()">üì• ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</button>
    </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  
  <script>
    const firebaseConfig = { 
	  apiKey: "AIzaSyDwKp_6znRl7TkIpXa3uFuZGOUxSHnkHOM",
      authDomain: "dailyreport-9512d.firebaseapp.com",
      databaseURL: "https://dailyreport-9512d-default-rtdb.firebaseio.com",
      projectId: "dailyreport-9512d",
      storageBucket: "dailyreport-9512d.appspot.com",
      messagingSenderId: "469725849063",
      appId: "1:469725849063:web:3d82a4560478d1b11f8942" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const tableBody = document.querySelector('#reportTable tbody');
    const finalTbody = document.querySelector('#finalTable tbody');

    const scoreMap = { 
	  dayFeeling: {"üòÉ ‡¶ñ‡ßÅ‡¶¨ ‡¶≠‡¶æ‡¶≤‡ßã": 1, "üôÇ ‡¶Æ‡ßã‡¶ü‡¶æ‡¶Æ‡ßÅ‡¶ü‡¶ø": 0.5, "üòê ‡¶ñ‡¶æ‡¶∞‡¶æ‡¶™": 0},
      learned: {"üìò ‡¶®‡¶§‡ßÅ‡¶® ‡¶¶‡ßã‡ßü‡¶æ/‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞": 1, "üìó ‡¶ï‡ßã‡¶∞‡¶Ü‡¶®‡ßá‡¶∞ ‡¶Ü‡ßü‡¶æ‡¶§/‡¶ó‡ßÄ‡¶§‡¶æ‡¶∞ ‡¶∂‡ßç‡¶≤‡ßã‡¶ï": 1, "üìô ‡¶ó‡¶£‡¶ø‡¶§/‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶®/‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü‡¶æ‡¶∞": 0.7, "üìô ‡¶®‡¶§‡ßÅ‡¶® ‡¶∂‡¶¨‡ßç‡¶¶‡¶æ‡¶∞‡ßç‡¶• (‡¶Ü‡¶∞‡¶¨‡ßÄ/‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø)": 0.7, "üìï ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶Ü‡¶¶‡¶¨/‡¶ß‡¶∞‡ßç‡¶Æ‡ßÄ‡ßü ‡¶Ü‡¶¶‡¶¨": 1, "ü§∑ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∂‡¶ø‡¶ñ‡¶ø‡¶®‡¶ø": 0},
      goodDeed: {"üïå ‡¶ï‡¶æ‡¶â‡¶ï‡ßá ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∂‡¶ø‡¶ñ‡¶ø‡ßü‡ßá‡¶õ‡¶ø": 1, "üëê ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø": 1, "üòä ‡¶≠‡¶æ‡¶≤‡ßã ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø": 0.7, "üëê ‡¶ï‡¶æ‡¶â‡¶ï‡ßá ‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡ßü‡ßá‡¶õ‡¶ø": 0.7, "üòá ‡¶Æ‡¶ø‡¶•‡ßç‡¶Ø‡¶æ ‡¶¨‡¶≤‡¶ø‡¶®‡¶ø": 0.7, "üôÅ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶ï‡¶∞‡¶ø‡¶®‡¶ø": 0},
      mistake: {"‚úÖ ‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡ßÅ‡¶≤ ‡¶ï‡¶∞‡¶ø‡¶®‡¶ø": 1, "‚úÖ ‡¶≠‡ßÅ‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ ‡¶ö‡ßá‡ßü‡ßá‡¶õ‡¶ø": 0.5, "üôä ‡¶Æ‡¶ø‡¶•‡ßç‡¶Ø‡¶æ ‡¶¨‡¶≤‡ßá‡¶õ‡¶ø": 0, "üò° ‡¶∞‡¶æ‡¶ó ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø": 0.3, "üìö ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏/‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá‡¶ü‡ßá‡¶∞ ‡¶™‡ßú‡¶æ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶π‡ßü‡¶®‡¶ø": 0.3, "üì± ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¶‡ßá‡¶ñ‡ßá‡¶õ‡¶ø": 0.2},
      lovedPerson: {"üë© ‡¶Æ‡¶æ": 1, "üë® ‡¶¨‡¶æ‡¶¨‡¶æ": 1, "üë®‚Äçüè´ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï": 0.75, "üëß ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ": 0.5, "ü§ê ‡¶ï‡ßá‡¶â ‡¶®‡¶æ": 0},
      thoughtAbout: {"üïã ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π/‡¶∏‡ßç‡¶∞‡¶∑‡ßç‡¶ü‡¶æ": 1, "üìñ ‡¶™‡ßú‡¶æ‡¶≤‡ßá‡¶ñ‡¶æ": 0.8, "‚öΩ ‡¶ñ‡ßá‡¶≤‡¶æ‡¶ß‡ßÅ‡¶≤‡¶æ": 0.4, "üëê ‡¶™‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞/‡¶Ö‡¶∞‡ßç‡¶•‡¶®‡ßÄ‡¶§‡¶ø": 0.6, "üëê ‡¶∏‡¶Æ‡¶æ‡¶ú/‡¶¶‡ßá‡¶∂": 0.6, "üôÇ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶®‡¶æ": 0},
      prayerTimes: {"üïã ‡ß´ ‡¶¨‡¶æ‡¶∞": 1, "üïå ‡ß©-‡ß™ ‡¶¨‡¶æ‡¶∞": 0.6, "üòï ‡ßß-‡ß® ‡¶¨‡¶æ‡¶∞": 0.3, "üôÅ ‡ßß ‡¶¨‡¶æ‡¶∞‡¶ì ‡¶®‡¶æ": 0},
      P H M: {"üîü ‡ßß‡ß¶‡ß¶%": 1, "‚ûê ‡ßØ‡ß¶%": 0.7, "‚ûå ‡ßÆ‡ß¶%": 0.3, "üôÅ ‡ß¶%": 0}   
	};

    function calculateStars(item) {
      let total = 0;
      for (let key in scoreMap) {
        total += scoreMap[key][item[key]] || 0;
      }
      return Math.round((total / 8) * 5);
    }
    function renderStars(n) {
      return "‚≠ê".repeat(n) + "‚òÜ".repeat(5 - n);
    }

    function refreshList() {
      const fDate = document.getElementById("dateFilter").value;
      const fName = document.getElementById("nameFilter").value.trim();
      const fClass = document.getElementById("classFilter").value;

      db.ref('dailyReports').once('value').then(snap => {
        tableBody.innerHTML = "";
        const data = snap.val();

        if (data) {
          Object.entries(data).forEach(([id, item]) => {
            const d = new Date(item.timestamp).toISOString().split("T")[0];
            if (
              (fDate && fDate !== d) ||
              (fName && !item.studentName.includes(fName)) ||
              (fClass && item.studentClass !== fClass)
            ) return;

            const stars = calculateStars(item);
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${d}</td>
              <td>${item.studentName}</td>
              <td>${item.studentClass}</td>
              <td>${item.studentRoll}</td>
              <td>${renderStars(stars)}</td>
              <td>${item.dayFeeling}</td>
              <td>${item.learned}</td>
              <td>${item.goodDeed}</td>
              <td>${item.mistake}</td>
              <td>${item.lovedPerson}</td>
              <td>${item.thoughtAbout}</td>
              <td>${item.prayerTimes}</td>
              <td>${item.P H M}</td>
              <td>
                <button class="edit-btn" onclick="window.location.href='edit.html?id=${id}'">‚úèÔ∏è</button>
                <button class="delete-btn" onclick="deleteReport('${id}')">üóëÔ∏è</button>
              </td>
            `;
            tableBody.appendChild(tr);
          });
        }
      });
    }

    function clearFilters() {
      document.getElementById("dateFilter").value = "";
      document.getElementById("nameFilter").value = "";
      document.getElementById("classFilter").value = "";
      refreshList();
    }

    function generateFinalReport() {
      const fDate = document.getElementById("dateFilter").value;
      const fName = document.getElementById("nameFilter").value.trim();
      const fClass = document.getElementById("classFilter").value;

      db.ref('dailyReports').once('value').then(snap => {
        finalTbody.innerHTML = "";
        const data = snap.val();

        if (data) {
          Object.values(data).forEach(item => {
            const d = new Date(item.timestamp).toISOString().split("T")[0];
            if (
              (fDate && fDate !== d) ||
              (fName && !item.studentName.includes(fName)) ||
              (fClass && item.studentClass !== fClass)
            ) return;

            let score = 0;
            for (let key in scoreMap) {
              score += scoreMap[key][item[key]] || 0;
            }
            const stars = Math.round((score / 8) * 5);
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${item.studentName}</td>
              <td>${item.studentClass}</td>
              <td>${item.studentRoll}</td>
              <td>${score.toFixed(2)}</td>
              <td>${renderStars(stars)}</td>
            `;
            finalTbody.appendChild(tr);
          });
        }
        document.getElementById("finalReport").style.display = "block";
      });
    }

    function deleteReport(id) {
      if (confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶ü‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
        db.ref('dailyReports/' + id).remove();
        refreshList();
      }
    }

    refreshList();
  </script>
  
  <script>
  function printFinalReport() {
    // ‡¶ï‡ßá‡¶¨‡¶≤ ‡¶ö‡ßÇ‡ßú‡¶æ‡¶®‡ßç‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶π‡¶¨‡ßá
    const printContent = document.getElementById("finalReport").innerHTML;
    const win = window.open('', '', 'width=900,height=700');
    win.document.write(`
      <html>
      <head>
        <title>Final Report</title>
        <style>
          body { font-family: Siyam Rupali, sans-serif; padding:20px; }
          table { width: 100%; border-collapse: collapse; }
          th, td { border: 1px solid #aaa; padding: 6px; text-align: center; }
          th { background: #007f5f; color: white; }
          tr:nth-child(even) { background: #f2f2f2; }
        </style>
      </head>
      <body>${printContent}</body></html>
    `);
    win.document.close();
    win.focus();
    win.print();
    win.close();
  }

  function exportToExcel() {
    let table = document.getElementById("finalTable");
    let html = table.outerHTML.replace(/ /g, '%20');
    const link = document.createElement('a');
    link.href = 'data:application/vnd.ms-excel,' + html;
    link.download = 'FinalReport.xls';
    link.click();
  }
</script>

<script>
  function verifyPassword() {
    const correctPassword = "19895"; // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®
    const userInput = document.getElementById("pagePassword").value;

    if (userInput === correctPassword) {
      document.getElementById("passwordPrompt").style.display = "none";
      document.getElementById("mainContent").style.display = "block";
    } else {
      document.getElementById("errorText").textContent = "‚õî ‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°! ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®‡•§";
    }
  }

  // ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¨‡¶®‡ßç‡¶ß ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶™‡ßá‡¶á‡¶ú ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã ‡¶•‡¶æ‡¶ï‡¶¨‡ßá
  document.getElementById("mainContent").style.display = "none";
</script>

</body>
</html>